###  Flowable 网关
网关用来控制流程的流向

### 一、排他网关
* 特点：对排他网关所有分支的条件进行判断，选择第一个条件计算为true的分支进行后续环节
* 注意
  * 当没有设置条件时，默认分支判断结果为true
  * 当有多个分支结果为true时，会选择XML中最先定义的分支继续流程
  * 如果没有可选的分支，会抛出异常

![](https://fgq233.github.io/imgs/workflow/flow08.png)

```
Map<String, Object> var = new HashMap<>();
var.put("num", 2);
taskService.complete("task1_id_......", var);
```

* 如图：两个分支条件分别是`${num < 3}、${num >= 3}`
* 当员工请假分支在完成任务时，传入网关判断需要的变量，进行结果为`true`的后续环节


### 二、并行网关
* 功能
  * `fork分支`：将流程分成多条分支，多条分支并行执行，互不影响
  * `join汇聚`：将多条分支汇聚成一条分支，所有到达并行网关分支在此等待，直到所有进入的分支都到达以后，流程就会通过并行网关
* 注意：
  * **一个并行网关**可以只fork分支，可以只join汇聚，也可以两个功能都有
  * 并行网关不会解析条件，即使顺序流中定义了条件，也会忽略

![](https://fgq233.github.io/imgs/workflow/flow09.png)


* 如图流程
* 当第一个环节完成后，通过并行网关，产生了 2 个分支
  * 任务表`act_ru_task`产生2条记录，2条记录的执行实例`execution_id`不一样
  * 然后在`act_ru_execution`中同时有三条记录，一个任务对应的有两个执行实例
* 当2个分支任务都完成后，才会通过第二个并行网关，进行下一环节

