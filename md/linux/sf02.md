### CentOS 系统安装 MySQL 8.X
 
### 一、卸载 mariadb
卸载掉 `CentOS` 自带的 `mariadb`

```
# 查询是否安装了mariadb
rpm -qa | grep mariadb

# 卸载mariadb
sudo rpm -e mariadb-libs-5.5.60-1.el7_5.x86_64

# 强制卸载
sudo rpm -e mariadb-libs-5.5.60-1.el7_5.x86_64 --nodeps
```


### 二、安装 MySQL 8.X
#### 1. 官网下载安装包
[https://downloads.mysql.com/archives/community/](https://downloads.mysql.com/archives/community/)

* `Red Hat Enterprise Linux 8 / Oracle Linux 8`   适用于`CentOS、Fedora、Oracle Linux`
* `Linux - Generic` 通用版本

#### 2. 上传安装包、解压
* `finalshell` 软件 使用 `root` 用户连接`CentOS`系统
* 使用拖拽方式，将安装包上传到`cd /usr/local`目录

```
# 进入目录
cd /usr/local

# 解压
tar -Jxvf mysql-8.0.25-linux-glibc2.12-x86_64.tar.xz 

# 改名
mv mysql-8.0.25-linux-glibc2.12-x86_64 ./mysql

# 创建数据存放目录
mkdir /usr/local/mysql/data
```

![](https://fgq233.github.io/imgs/linux/sf003.png)



#### 3. 配置环境变量
```
# 通过 vim 编辑器打开系统环境变量配置文件
vim /etc/profile
```

```
# 在 profile 文件添加环境变量
export PATH=$PATH:/usr/local/mysql/bin
```

```
# 重新加载配置文件，使配置文件生效
source /etc/profile

# 查看 PATH 环境变量
echo $PATH
```


#### 4. 编辑配置文件 my.cnf
`vim /etc/my.cnf`


```
[client]
port=3306

[mysql]
default-character-set=utf8

[mysqld]
bind-address=0.0.0.0
port=3306
socket=/tmp/mysql.sock
basedir=/usr/local/mysql
datadir=/usr/local/mysql/data
max_connections=1000
max_connect_errors=100
default-storage-engine=INNODB
character-set-server=utf8mb4
log-error=/usr/local/mysql/data/mysql.err
```


#### 5. 创建用户组、用户、授权
```
# 创建用户组
groupadd mysql

# 创建用户并加入用户组
useradd -r -g mysql mysql  

# 变更所属用户、用户组
chown -R mysql:mysql /usr/local/mysql
```



#### 6. 初始化数据库
```
# 初始化数据库
mysqld --defaults-file=/etc/my.cnf --initialize  --user=mysql

# 查看 root 初始密码
cat /usr/local/mysql/data/mysql.err
```



### 三、配置服务
#### 1. 复制启动脚本到资源目录
```
cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql
```


#### 2. mysql文件添加执行权限
```
chmod +x /etc/rc.d/init.d/mysql
```


#### 3. mysql 服务添加至系统服务
```
chkconfig --add mysql
```


#### 4. 查询 mysql 服务
```
chkconfig --list mysql
```

#### 5. 启动、重启、停止 mysql 服务
```
# 启动
service mysql start

# 重启
service mysql reload

# 停止
service mysql stop
```


#### 6. 开放端口
```
# 开放3306端口
firewall-cmd --zone=public --add-port=3306/tcp --permanent

# 重新加载防火墙
firewall-cmd --reload
```



### 四、MySQL 账号配置
#### 1. 修改 root 密码
```
# 登录
mysql -uroot -p

# 修改临时密码
alter user 'root'@'localhost' identified by '123456';
```


#### 2. 创建远程连接用户
```
# 创建测试库
create database test;

# 创建远程连接用户
create user 'fgq'@'%' identified by '123456';

# 授权
grant all privileges on test.* to 'fgq'@'%';  

# 刷新权限
flush privileges;  
 
# 查询权限
show grants for 'fgq';
```