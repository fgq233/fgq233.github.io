###  一、lucene 索引存储结构
lucene 在存储它的全文索引结构时，是有层次结构的，主要是5个层次：
> 索引(Index) > 段(Segment) > 文档(Document) > 域(Field) > 词(Term)


![lucene1](https://fgq233.github.io/imgs/java/lucene.png) 



###  二、说明
#### 1. 索引(Index)
每个索引都是放在同一个文件夹中，文件夹中的所有文件构成一个索引

#### 2. 段(Segment)
* segment_n: 该文件保存段的元数据信息，每个索引包含了多个段
* segment.gen: 保存了段的属性信息，存在多个segment_n时选择打开哪一个，Lucene会选择generation最大的
* 段的作用是：为新加入的文档创建单独的段结构、合并已经存在的段
* Lucene采用的增量索引的模式写入文件，即新的文件都会放在一个新的段中，然后周期性的对以前的段进行合并


#### 3. 文档(Document)
* 文档是建立索引的基本单位，不同的文档是保存在不同的段中的，一个段可以包含多篇文档
* 新添加的文档是单独保存在一个新生成的段中，随着段的合并，不同的文档合并到同一个段中

#### 4. 域(Field)
* 一篇文档包含不同类型的信息，可以分开索引，比如标题，时间，作者等，都可以保存在不同的域里
* 不同域的索引方式可以不同

#### 5. 词(Term)
词是索引的最小单位，是经过词法分析和语言处理后的字符串


###  三、正向索引、倒排索引
#### 1. 正向索引
* 传统索引方式，在做词条查询时，先逐条获取文档，再判断文档中是否有某个词条，是**根据文档找词条的过程**
* 优点：可以给多个字段创建索引，根据索引字段查询的速度非常快
* 缺点：根据非索引字段，或者索引字段中的部分词条查找时，只能全表扫描，速度慢


#### 2. 倒排索引
* 与正向索引相反，先找到要搜索的词条，根据词条得到其所在文档的id，然后根据id获取文档，是**根据词条找文档的过程**
* 优点：擅长海量数据的搜索，Lucene、Solr、Elasticsearch采用的就是倒排索引

倒排索引中两个概念：
* 文档(Document)：用来搜索的数据，其中的每一条数据就是一个文档
* 词条(Term)：对文档数据或用户搜索数据，利用某种分词算法，得到的具备含义的词语
