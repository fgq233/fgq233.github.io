### MongoDB 集群部署模式

### 一、MongoDB 三种集群部署模式
MongoDB 有三种集群部署模式
* 主从复制（`Master-Slaver`）: 有固定的主节点、从节点，无法自动故障转移，mongodb4.0后不再支持

* 副本集（`Replica Set`）: 是一种互为主从的关系，类似于有**自动故障恢复**功能的主从集群，**不同服务器保存同一份数据**，
在出现故障时自动切换，实现故障转移
 
* 分片（`Sharding`）: 适合处理大量数据，它将数据分开存储，**不同服务器保存不同的数据**，
所有服务器数据的总和即为整个数据集



 
### 二、副本集
主从集群和副本集最大的区别就是副本集可以自动故障转移，没有固定的主节点，整个集群会选出一个主节点，
当其挂掉后，又在剩下的从节点中选中其他节点为主节点

#### 1. 三大角色
![mongodb](https://fgq233.github.io/imgs/java/mongodb1.png)

副本集有三种角色，其中仲裁者永远是仲裁者，而主要人员可能会退出并成为次要人员，
次要人员可能成为选举期间的主要成员

* 主要成员（`Primary`）：数据操作的主要连接点，可进行`读写操作`

* 副本成员（`Secondaries`）：从主要成员复制相同的数据集，即备份数据，不可写操作，但可以读操作（`需要配置`）

* 仲裁者（`Arbiter`）：不存储数据集，只有投票选举作用，占用资源成本低
    * 副本 + 主节点的个数是偶数，建议加一个仲裁者形成奇数，容易满足大多数的投票
    * 副本 + 主节点的个数是奇数，可以不加仲裁者
 