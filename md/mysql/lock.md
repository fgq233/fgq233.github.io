### MySQL中的锁
锁是对访问某一资源的限制，通常是为了保持并发访问数据时的一致性、有效性

### 一、锁的分类
锁按照锁的范围，分为3类
* 全局锁：锁定数据库中的所有表
* 表级锁：锁定整张表
  * 表锁
    * 读锁
    * 写锁
  * 元数据锁
  * 意向锁
  * 读锁
  * 写锁
* 行级锁；锁定表中对应的行数据


### 二、全局锁
#### 1. 效果
![lock1](https://fgq233.github.io/imgs/mysql/lock1.png)

* 对整个数据库实例枷锁，加锁后
  * 数据库实例处于只读状态，只能执行 DQL语句
  * 后续 DML、DDL语句都将被堵塞，直到锁释放
* 应用场景：`mysqldump` 进行数据库备份时，加全局锁保证数据一致性、完整性

#### 2. 全局锁语法
```
-- 加全局读锁
flush tables with read lock;

-- 释放锁
unlock tables;
```


### 三、表级锁
#### 1. 分类
![lock1](https://fgq233.github.io/imgs/mysql/lock1.png)

表级锁分为3类
* 表锁
  * 读锁：也叫共享锁，加了读锁后，加锁的当前会话以及其它会话**只能进行读操作**
  * 写锁：也叫排他锁，加了写锁之后其它会话**不能进行读写操作**
* 元数据锁（meta data lock, MDL）
* 意向锁
  

#### 2. 表锁
```
-- 加读锁、写锁
lock tables 表名... read;
lock tables 表名... write;

-- 释放锁
unlock tables;
```






















