### OAuth2 相关概念
### 一、概念
#### 1. OAuth、OAuth2
* `OAuth（Open Authorization）`是用于**用户资源授权**的行业标准协议
* `OAuth2.0` 是`OAuth1.0` 协议的延续版本，但不向兼容 `OAuth1.0`
   
#### 2. OAuth2 相关名词
* `Resource owner`（资源拥有者）：拥有该资源的最终用户，拥有访问资源的账号密码

* `Resource server`（资源服务器）：拥有受保护资源的服务器，如果请求包含正确的访问令牌，则可以访问该资源服务器

* `Client`（客户端）：访问资源的客户端，会使用访问令牌去获取资源服务器的资源，可以是浏览器、移动设备或者服务器等

* `Authorization server`（授权服务器）：用于认证用户的服务器，如果客户端认证通过，发放访问资源服务器的令牌


### 二、OAuth2 运行流程
![SpringSecurity](https://fgq233.github.io/imgs/java/oauth2.png)
* 客户端要求用户给予授权
* 用户同意给予客户端授权
* 客户端使用上一步获得的授权，向认证服务器申请令牌
* 认证服务器对客户端进行认证以后，确认无误，同意发放令牌
* 客户端使用令牌，向资源服务器申请获取资源
* 资源服务器确认令牌无误，同意向客户端开放资源



### 二、OAuth2 四种授权模式
#### 1. 授权码模式 Authorization Code
![SpringSecurity](https://fgq233.github.io/imgs/java/oauth2_1.png)


* 客户端请求第三方授权
    * 用户进入百度登录页面，点击微信图标以微信账号登录系统
    * 弹出微信二维码扫描界面，携带`客户端标识、重定向url`请求授权
    * 用户自己的微信账号就是资源拥有者
    
* 用户同意授权，返回授权码
    * 微信先验证资源拥有者身份，即登录自己的微信账号
    * 微信认证登录成功，会询问用户是否授权给百度访问自己的微信数据
    * 用户点击确认登录，同意授权，返回一个授权码给百度
    
* 客户端使用上一步返回的授权码，向认证服务器申请令牌
    * 客户端应用携带授权码请求微信认证服务器（此过程用户看不到）

* 认证服务器对客户端进行认证以后，确认无误，同意发放令牌
    * 微信认证服务器验证客户端授权码合法，向客户端颁发令牌（此过程用户看不到）
    * 用户拿到令牌后，在百度可以看到登录成功
    
* 客户端使用令牌，向资源服务器申请获取资源
    * 百度携带令牌访问微信资源服务器
    
* 资源服务器确认令牌无误，同意向客户端开放资源
    * 微信资源服务器返回：微信用户的信息 
    
#### 2. 简化模式 Implicit
和授权码模式相比，取消了使用授权码向认证服务器申请令牌过程，授权通过直接颁发访问令牌

#### 3. 密码模式 Resource Owner Password Credentials
客户端有认证服务器的用户名、密码，直接向认证服务器获取访问令牌

#### 4. 客户端模式 Client Credentials
直接由客户端将认证信息发送到认证服务器，认证服务器校验通过之后返回Access Token给客户应用

 































